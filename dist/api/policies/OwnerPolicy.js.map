{"version":3,"sources":["policies/OwnerPolicy.js"],"names":[],"mappings":";;;;;;;AAKA,MAAM,CAAC,OAAO,GAAG,SAAS,WAAW,CAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;;AAErD,MAAI,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE;AAC7B,OAAG,CAAC,MAAM,EAAE,CAAC;AACb,WAAO,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC,CAAC;GACxD;;;;;;;;AAQD,MAAI,GAAG,CAAC,OAAO,CAAC,eAAe,CAAC,aAAa,KAAK,KAAK,EAAE;;AAEvD,WAAO,IAAI,EAAE,CAAC;GACf;;AAED,MAAI,MAAM,IAAI,GAAG,CAAC,MAAM,EAAE;;AAExB,OAAG,CAAC,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;AACjC,OAAG,CAAC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;GAC9B;;;AAGD,MAAI,EAAE,CAAC;CACR,CAAC","file":"OwnerPolicy.js","sourcesContent":["/**\n * TODO - this is setting createdBy, not owner.\n * The comment below, and the name of this file/function is confusing to me\n * Ensure that the 'owner' property of an Object is set upon creation.\n */\nmodule.exports = function OwnerPolicy (req, res, next) {\n  //sails.log('OwnerPolicy()');\n  if (!req.user || !req.user.id) {\n    req.logout();\n    return res.send(500, new Error('req.user is not set'));\n  }\n\n  /*\n  sails.log.verbose('OwnerPolicy user', req.user);\n  sails.log.verbose('OwnerPolicy method', req.method);\n  sails.log.verbose('OwnerPolicy req.body', req.body);\n  */\n\n  if (req.options.modelDefinition.autoCreatedBy === false) {\n    // sails.log.verbose('OwnerPolicy hasOwnershipPolicy: false');\n    return next();\n  }\n\n  if ('POST' == req.method) {\n    //req.body || (req.body = { });\n    req.body.createdBy = req.user.id;\n    req.body.owner = req.user.id;\n  }\n\n  //sails.log.verbose('OwnerPolicy req.model', req.model);\n  next();\n};\n"]}